<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets">
<ui:composition template="template.xhtml">
	<ui:define name="title">
		<h:outputText value="#{msg.edit_of} #{msg.menu_items}" />
	</ui:define>		
	<ui:define name="content">
	<div class="block">
		<div class="block-header">			
			<h3 class="block-title"><h:outputText styleClass="font-w600" value="Bienvenido #{loginMb.currentUser.userName}" /></h3>
		</div>	
		<h:panelGroup layout="block-content" id="postList">
		<ui:repeat var="p" value="#{postMb.posts}">
			<table class="table table-bordered table-striped">
					<tbody>
							<tr>								
								<td class="text-center" style="width: 10%;">
									<h:outputText value="#{p.date}" >
										<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
									</h:outputText>
								</td>
								<td class="font-w600"><span class="label label-info">#{p.user.userName}</span> #{p.content}</td>				
							</tr>						
						
					</tbody>					
			</table>	
			<ul class="list-group">
			<ui:repeat var="c" value="#{commentMb.listByPost(p)}">
				<li class="list-group-item">
					<small>
						<h:outputText value="#{c.date}" >
							<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
						</h:outputText>
					</small>
					<strong>
						<h:outputText value="#{c.user.userName}" />
					</strong>
					<h:outputText value="#{c.content}" />
				</li>
			</ui:repeat>
				<h:form rendered="#{loginMb.logged}">
					<h:inputText value="#{commentMb.comment}" styleClass="form-control" />
					<h:commandLink styleClass="btn btn-primary" action="#{commentMb.create(p)}" >Agregar comentario</h:commandLink>
				</h:form>
			</ul>
		</ui:repeat>
		</h:panelGroup>
	</div>	
	<div class="block">
		<div class="block-header">
			<h3 class="block-title">Nuevo post</h3>
		</div>	
		<h:form styleClass="form-inline">
			<h:panelGroup layout="block" rendered="#{!loginMb.logged}">
				<h:outputText value="Inicia sesion para agregar nuevos posts." />
			</h:panelGroup>
			<h:panelGroup layout="block" rendered="#{loginMb.logged}">
				<h:inputText styleClass="form-control" value="#{postMb.content}"/>
				<h:commandLink action="#{postMb.add()}" styleClass="btn btn-danger">Enviar</h:commandLink>		
			</h:panelGroup>
			<h:messages globalOnly="true" errorClass="alert alert-danger"/>
		</h:form>				
	</div>				
	</ui:define>
</ui:composition>
</html>